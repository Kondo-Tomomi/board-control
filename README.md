# board-control
### 概要
ロボットビジョンという実験で、Webカメラと板とサーボを用いて、板の上のビー玉を制御することを目指した。
### 使用言語
Python
### プログラムの流れ
Webカメラで撮った映像から、指定した色の領域の重心を割り出すプログラムが与えられ、それを利用して制御を行った。  
ある一点を目標地点に設定し、その地点にボールを静止させることができるようにして、その目標地点を少しずつ動かすことにより思った通りの運動をさせるようにした。  
試行を繰り返す中で、パラメータの値と目標地点を動かす細かさや時間間隔を調整した。  
いずれもPID制御法を参考に、ビー玉の位置と速度を利用してサーボの傾きを決定している。　　
### 傾きの決定方法
x軸方向の傾き = Kp*(目標地点のx座標-現在のx座標) + Kd*((目標地点のx座標-現在のx座標)の時間微分)  
y軸方向の傾き = Kp*(目標地点のy座標-現在のy座標) + Kd*((目標地点のy座標-現在のy座標)の時間微分)  
これらの数式を利用してサーボの傾きを決定。KpやKdといったパラメータを調整しながら何度も試行を繰り返し、最適な値を求めた。
### プログラム内容
2b_circle_new.py：盤面上の2つの円柱の回りをビー玉が回るようにするプログラム  
3_figure_eight.py：2つの円柱を8の字で回るようにするプログラム  
4_gate_pass.py：3つの門を円柱で作り、その間を通るようにするプログラム
### ビー玉が8の字運動をしている様子
[![](https://img.youtube.com/vi/FiebarI8sQ0/0.jpg)](https://www.youtube.com/watch?v=FiebarI8sQ0)　　
### 工夫した点
* 板の反りを考慮して、その位置に目標地点が設定された際、少し内側に修正するようにした  
* 加速度が大きくなった際、サーボの傾きが大きくなり故障につながるため、左右のサーボの角度の比率をそのままにして、ある一定の値を超えないように調整するようにした  
* パラメータを調整しやすいよう、なるべく変数を使用しプログラムを書いた    
### 課題
* 目標地点を動かす速度を速くすると、制御が上手くできなくなってしまうため、滑らかな運動を実現できていない
* 繰り返し試行を行ったため正規品のサーボが故障してしまい、代替品のサーボを使用したが、反応が悪くビー玉を静止させられなくなってしまっている
